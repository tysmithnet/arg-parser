<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Styles\ParseStrategy\ConsumptionRequestFactory.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using ArgParser.Core;

namespace ArgParser.Styles.ParseStrategy
{
    public class ConsumptionRequestFactory : IConsumptionRequestFactory
    {
        public ConsumptionRequestFactory(IContext context)
        {
            Context = context.ThrowIfArgumentNull(nameof(context));
        }

        public ConsumptionRequest Create(PotentialConsumerResult consumerResult, ConsumptionResult selected)
        {
            for (var i = 1;
                i &lt; selected.NumConsumed;
                i++)
                foreach (var parser in consumerResult.Chain)
                {
                    var info = consumerResult.Info.Consume(i);
                    var res = parser.CanConsume(selected, info);
                    if (res.Info &gt; info &amp;&amp; res.ConsumingParameter != null &amp;&amp; res.ConsumingParameter is Switch)
                        return new ConsumptionRequest(consumerResult.Info, i);
                }

            return new ConsumptionRequest(consumerResult.Info, selected.NumConsumed);
        }

        public IContext Context { get; set; }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[7,9,7,59,1],[8,9,8,10,1],[9,13,9,68,1],[10,9,10,10,1],[13,9,13,10,1],[14,18,14,27,1],[15,17,15,41,1],[16,17,16,20,1],[17,17,17,24,1],[17,26,17,36,1],[17,37,17,39,1],[17,40,17,60,1],[18,17,18,18,1],[19,21,19,63,1],[20,21,20,65,1],[21,21,21,111,1],[22,25,22,79,1],[23,17,23,18,1],[25,13,25,86,1],[26,9,26,10,1]]);
    </script>
  </body>
</html>