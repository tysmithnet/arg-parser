<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Styles\ParserRepository.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using ArgParser.Core;

namespace ArgParser.Styles
{
    public class ParserRepository : IParserRepository
    {
        public Parser Create(string id)
        {
            if (Parsers.ContainsKey(id))
                throw new ArgumentException($&quot;Parser already exists with id={id}&quot;);
            var parser = new Parser(id);
            if (FirstAdded == null)
                FirstAdded = parser;
            Parsers.Add(id, parser);
            return parser;
        }

        public Parser&lt;T&gt; Create&lt;T&gt;(string id)
        {
            if (Parsers.ContainsKey(id)) // todo: duplicate code
                throw new ArgumentException($&quot;Parser already exists with id={id}&quot;);
            var parser = new Parser&lt;T&gt;(id);
            if (FirstAdded == null)
                FirstAdded = parser;
            Parsers.Add(id, parser);
            return parser;
        }

        public Parser Get(string id)
        {
            if (!Parsers.ContainsKey(id))
                throw new KeyNotFoundException(
                    $&quot;Unable to find parser with id={id}, are you sure it was added and you are using the correct id?&quot;);
            return Parsers[id];
        }

        public Parser&lt;T&gt; Get&lt;T&gt;(string id)
        {
            var parser = Get(id);
            return (Parser&lt;T&gt;) parser;
        }

        public IEnumerable&lt;Parser&gt; GetAll() =&gt; Parsers.Values;

        protected internal Parser FirstAdded { get; set; }

        protected internal Dictionary&lt;string, Parser&gt; Parsers { get; set; } = new Dictionary&lt;string, Parser&gt;();
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[10,9,10,10,1],[11,13,11,41,1],[12,17,12,84,1],[13,13,13,41,1],[14,13,14,36,1],[15,17,15,37,1],[16,13,16,37,1],[17,13,17,27,1],[18,9,18,10,1],[21,9,21,10,1],[22,13,22,41,1],[23,17,23,84,1],[24,13,24,44,1],[25,13,25,36,1],[26,17,26,37,1],[27,13,27,37,1],[28,13,28,27,1],[29,9,29,10,1],[32,9,32,10,1],[33,13,33,42,1],[34,17,35,121,1],[36,13,36,32,1],[37,9,37,10,1],[40,9,40,10,1],[41,13,41,34,1],[42,13,42,39,1],[43,9,43,10,1],[45,48,45,62,1],[49,79,49,111,1]]);
    </script>
  </body>
</html>