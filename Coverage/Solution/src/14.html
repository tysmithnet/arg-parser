<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Core\Help\DefaultHelpBuilder.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;

namespace ArgParser.Core.Help
{
    public class DefaultHelpBuilder : IHelpBuilder
    {
        public DefaultHelpBuilder AddGenericHelp(IGenericHelp help)
        {
            Help = help;
            return this;
        }

        public DefaultHelpBuilder AddParameter(string name, string[] usages, string shortDescription)
        {
            ParameterInfos.Add(new ParameterInfo
            {
                Name = name,
                Usages = usages,
                ShortDescription = shortDescription
            });
            return this;
        }

            
        public IHelpNode Build()
        {
            var header = BuildHeader();
            var body = BuildBody();
            var footer = BuildFooter();
            var all = new[] {header, body, footer}.Where(x =&gt; !x.IsNullOrWhiteSpace()).Join(Environment.NewLine);
            return new TextNode(all);
        }

        private string BuildBody()
        {
            if (!ParameterInfos.Any())
                return null;
            var sb = new StringBuilder();
            foreach (var info in ParameterInfos)
            {
                var firstLine = new[] {info.Name, info.ShortDescription}.JoinNonNullOrWhiteSpace(&quot; - &quot;);
                if (!firstLine.IsNullOrWhiteSpace()) sb.AppendLine(firstLine.Trim());

                foreach (var usage in info.Usages.PreventNull()) sb.AppendLine($&quot;    {usage}&quot;);

                sb.AppendLine();
            }

            return sb.ToString();
        }

        private string BuildFooter() =&gt; Help?.Author.IsNullOrWhiteSpace() ?? true ? null : $&quot;Author: {Help.Author}&quot;;

        private string BuildHeader()
        {
            if (Help == null)
                return null;
            var sb = new StringBuilder();
            var first = new[] {Help.Name, Help.Version, Help.ShortDescription}.JoinNonNullOrWhiteSpace(&quot; - &quot;);
            sb.AppendLine(first);
            if (Help.Description != null)
                sb
                    .AppendLine(Help.Description);

            return sb.ToString();
        }

        public IGenericHelp Help { get; set; }

        public IList&lt;ParameterInfo&gt; ParameterInfos { get; set; } = new List&lt;ParameterInfo&gt;();

        public class ParameterInfo
        {
            public string Name { get; set; }
            public string ShortDescription { get; set; }
            public string[] Usages { get; set; }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[11,9,11,10,1],[12,13,12,25,1],[13,13,13,25,1],[14,9,14,10,1],[17,9,17,10,1],[18,13,23,16,1],[24,13,24,25,1],[25,9,25,10,1],[29,9,29,10,1],[30,13,30,40,1],[31,13,31,36,1],[32,13,32,40,1],[33,13,33,63,1],[33,63,33,86,1],[33,86,33,114,1],[33,13,33,114,1],[34,13,34,38,1],[35,9,35,10,1],[38,9,38,10,1],[39,13,39,39,1],[40,17,40,29,1],[41,13,41,42,1],[42,13,42,20,1],[42,22,42,30,1],[42,31,42,33,1],[42,34,42,48,1],[43,13,43,14,1],[44,17,44,105,1],[45,17,45,53,1],[45,54,45,86,1],[47,17,47,24,1],[47,26,47,35,1],[47,36,47,38,1],[47,39,47,64,1],[47,66,47,96,1],[49,17,49,33,1],[50,13,50,14,1],[52,13,52,34,1],[53,9,53,10,1],[55,41,55,116,1],[58,9,58,10,1],[59,13,59,30,1],[60,17,60,29,1],[61,13,61,42,1],[62,13,62,111,1],[63,13,63,34,1],[64,13,64,42,1],[65,17,66,51,1],[68,13,68,34,1],[69,9,69,10,1],[73,68,73,93,1]]);
    </script>
  </body>
</html>