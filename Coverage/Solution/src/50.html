<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Core\Parameter.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Linq;
using ArgParser.Core.Help;

namespace ArgParser.Core
{
    public abstract class Parameter : IConsumer
    {
        protected Parameter(Parser parent, Action&lt;object, string[]&gt; consumeCallback)
        {
            Parser = parent.ThrowIfArgumentNull(nameof(parent));
            ConsumeCallback = consumeCallback.ThrowIfArgumentNull(nameof(consumeCallback));
        }

        protected Parameter()
        {
        }

        public abstract ConsumptionResult CanConsume(object instance, IterationInfo info);

        public virtual ConsumptionResult Consume(object instance, ConsumptionRequest request)
        {
            try
            {
                if (request.Max &lt; MinRequired)
                    throw new MissingValueException(this,
                        $&quot;Switch {this} expected to have at least {MinRequired} values, but was told it can only have {request.Max}. Are you sure you passed enough values to satisfy the switch?&quot;);
                HasBeenConsumed = true;
                var values = request.AllToBeConsumed().Take(MaxAllowed).ToArray();
                ConsumeCallback(instance, values);
                return new ConsumptionResult(request.Info, values.Length, this);
            }
            catch (ParseException pe)
            {
                return new ConsumptionResult(pe);
            }
        }

        public void Reset()
        {
            HasBeenConsumed = false;
        }

        public Action&lt;object, string[]&gt; ConsumeCallback { get; protected internal set; }
        public bool HasBeenConsumed { get; protected internal set; }

        public ParameterHelp Help { get; set; } = new ParameterHelp();
        public int MaxAllowed { get; set; } = int.MaxValue;
        public int MinRequired { get; set; } = 1;
        public Parser Parser { get; protected internal set; }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[9,9,9,85,1],[10,9,10,10,1],[11,13,11,65,1],[12,13,12,92,1],[13,9,13,10,1],[15,9,15,30,1],[16,9,16,10,1],[17,9,17,10,1],[22,9,22,10,1],[24,13,24,14,1],[25,17,25,47,1],[26,21,27,197,1],[28,17,28,40,1],[29,17,29,83,1],[30,17,30,51,1],[31,17,31,81,1],[33,13,33,38,1],[34,13,34,14,1],[35,17,35,50,1],[37,9,37,10,1],[40,9,40,10,1],[41,13,41,37,1],[42,9,42,10,1],[47,51,47,70,1],[47,51,47,70,1],[48,47,48,59,1],[48,47,48,59,1],[49,48,49,49,1],[49,48,49,49,1]]);
    </script>
  </body>
</html>