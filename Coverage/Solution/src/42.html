<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Core\ConsumptionRequestExtensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;
using System.Linq;

namespace ArgParser.Core
{
    public static class ConsumptionRequestExtensions
    {
        public static IEnumerable&lt;string&gt; AllToBeConsumed(this ConsumptionRequest request) =&gt;
            request.Info.Args.Skip(request.Info.Index).Take(request.Max);

        public static string First(this ConsumptionRequest request)
        {
            var from = request.AllToBeConsumed().ToList();
            if (!from.Any())
                throw new IndexOutOfRangeException();
            return from.First();
        }

        public static bool HasNext(this ConsumptionRequest request) =&gt;
            request.Info.Index + 1 &lt; request.Info.Index + request.Max;

        public static string Last(this ConsumptionRequest request)
        {
            var from = request.AllToBeConsumed().ToList();
            if (!from.Any())
                throw new IndexOutOfRangeException();
            return from.Last();
        }

        public static string Next(this ConsumptionRequest request)
        {
            if (request.Max &lt; 2)
                throw new IndexOutOfRangeException(
                    &quot;Cannot get next arg because it is outside the range of consumable values&quot;);
            return request.Info.Args[request.Info.Index + 1];
        }

        public static IEnumerable&lt;string&gt; Rest(this ConsumptionRequest request) =&gt;
            request.Info.Args.Skip(request.Info.Index + 1).Take(request.Max - 1);
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[10,13,10,73,1],[13,9,13,10,1],[14,13,14,59,1],[15,13,15,29,1],[16,17,16,54,1],[17,13,17,33,1],[18,9,18,10,1],[21,13,21,70,1],[24,9,24,10,1],[25,13,25,59,1],[26,13,26,29,1],[27,17,27,54,1],[28,13,28,32,1],[29,9,29,10,1],[32,9,32,10,1],[33,13,33,33,1],[34,17,35,97,1],[36,13,36,62,1],[37,9,37,10,1],[40,13,40,81,1]]);
    </script>
  </body>
</html>