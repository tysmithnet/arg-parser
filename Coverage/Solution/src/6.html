<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Core\DefaultParseStrategy.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
using System;
using System.Collections.Generic;

namespace ArgParser.Core
{
    public class DefaultParseStrategy : IParseStrategy
    {
        public IList&lt;Func&lt;object&gt;&gt; FactoryFunctions { get; set; } = new List&lt;Func&lt;object&gt;&gt;();
        public IIterationInfoFactory IterationInfoFactory { get; set; } = new DefaultIterationInfoFactory();

        /// &lt;inheritdoc /&gt;
        public DefaultParseStrategy(IEnumerable&lt;Func&lt;object&gt;&gt; factoryFuncs = null)
        {
            foreach (var factoryFunc in factoryFuncs ?? new Func&lt;object&gt;[0])
            {
                FactoryFunctions.Add(factoryFunc);
            }
        }

        /// &lt;inheritdoc /&gt;
        public IParseResult Parse(IEnumerable&lt;IParser&gt; parsers, string[] args)
        {
            var results = new List&lt;object&gt;();
            foreach (var parser in parsers)
            {
                foreach (var factoryFunction in FactoryFunctions)
                {
                    var info = IterationInfoFactory.Create(args);
                    var instance = factoryFunction();
                    bool hasFailed = false;
                    int last = 0;
                    while (!hasFailed &amp;&amp; !info.IsComplete &amp;&amp; parser.CanConsume(instance, info))
                    {
                        info = parser.Consume(instance, info);
                        if (info.Index &lt;= last)
                        {
                            hasFailed = true;
                        }
                    }

                    if (!hasFailed &amp;&amp; info.IsComplete)
                    {
                        results.Add(instance);
                    }
                }
            }
            return new DefaultParseResult(results);
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[8,69,8,93,1],[9,75,9,108,1],[12,9,12,83,1],[13,9,13,10,1],[14,13,14,20,1],[14,22,14,37,1],[14,38,14,40,1],[14,41,14,76,1],[15,13,15,14,1],[16,17,16,51,1],[17,13,17,14,1],[18,9,18,10,1],[22,9,22,10,1],[23,13,23,46,1],[24,13,24,20,1],[24,22,24,32,1],[24,33,24,35,1],[24,36,24,43,1],[25,13,25,14,1],[26,17,26,24,1],[26,26,26,45,1],[26,46,26,48,1],[26,49,26,65,1],[27,17,27,18,1],[28,21,28,66,1],[29,21,29,54,1],[30,21,30,44,1],[31,21,31,34,1],[32,21,32,96,1],[33,21,33,22,1],[34,25,34,63,1],[35,25,35,48,1],[36,25,36,26,1],[37,29,37,46,1],[38,25,38,26,1],[39,21,39,22,1],[41,21,41,55,1],[42,21,42,22,1],[43,25,43,47,1],[44,21,44,22,1],[45,17,45,18,1],[46,13,46,14,1],[47,13,47,52,1],[48,9,48,10,1]]);
    </script>
  </body>
</html>