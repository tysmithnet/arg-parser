<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>C:\projects\arg-parser\ArgParser\ArgParser.Core\DefaultParameter.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ***********************************************************************
// Assembly         : ArgParser.Core
// Author           : @tysmithnet
// Created          : 10-20-2018
//
// Last Modified By : @tysmithnet
// Last Modified On : 10-21-2018
// ***********************************************************************
// &lt;copyright file=&quot;Parameter.cs&quot; company=&quot;ArgParser.Core&quot;&gt;
//     Copyright (c) . All rights reserved.
// &lt;/copyright&gt;
// &lt;summary&gt;&lt;/summary&gt;
// ***********************************************************************

using System;

namespace ArgParser.Core
{
    public class DefaultParameter : IParameter
    {
        /// &lt;inheritdoc /&gt;
        public DefaultParameter(Func&lt;object, IIterationInfo, bool&gt; canConsumeCallback,
            Func&lt;object, IIterationInfo, IIterationInfo&gt; consumeCallback)
        {
            CanConsumeCallback = canConsumeCallback ?? throw new ArgumentNullException(nameof(canConsumeCallback));
            ConsumeCallback = consumeCallback ?? throw new ArgumentNullException(nameof(consumeCallback));
        }

        internal DefaultParameter()
        {
        }

        /// &lt;inheritdoc /&gt;
        public bool CanConsume(object instance, IIterationInfo info) =&gt;
            CanConsumeCallback?.Invoke(instance, info) ?? false;

        /// &lt;inheritdoc /&gt;
        public IIterationInfo Consume(object instance, IIterationInfo info) =&gt;
            ConsumeCallback?.Invoke(instance, info) ?? info;

        public Func&lt;object, IIterationInfo, bool&gt; CanConsumeCallback { get; set; }
        public Func&lt;object, IIterationInfo, IIterationInfo&gt; ConsumeCallback { get; set; }
    }

    public class DefaultParameter&lt;T&gt; : DefaultParameter, IParameter&lt;T&gt;
    {
        /// &lt;inheritdoc /&gt;
        public DefaultParameter(
            Func&lt;T, IIterationInfo, bool&gt; canConsumeCallback,
            Func&lt;T, IIterationInfo, IIterationInfo&gt; consumeCallback)
        {
            if (canConsumeCallback == null)
                throw new ArgumentNullException(nameof(canConsumeCallback));
            if (consumeCallback == null)
                throw new ArgumentNullException(nameof(consumeCallback));
            CanConsumeCallback = (obj, info) =&gt;
            {
                if (obj is T casted)
                    return canConsumeCallback(casted, info);
                return false;
            };
            ConsumeCallback = (obj, info) =&gt;
            {
                if (obj is T casted)
                    return consumeCallback(casted, info);
                return info;
            };
        }

        /// &lt;inheritdoc /&gt;
        public bool CanConsume(T instance, IIterationInfo info) =&gt; CanConsumeCallback(instance, info);

        /// &lt;inheritdoc /&gt;
        public IIterationInfo Consume(T instance, IIterationInfo info) =&gt; ConsumeCallback(instance, info);
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[22,9,23,74,1],[24,9,24,10,1],[25,13,25,116,1],[26,13,26,107,1],[27,9,27,10,1],[29,9,29,36,1],[30,9,30,10,1],[31,9,31,10,1],[35,13,35,64,1],[39,13,39,60,1],[48,9,50,69,1],[51,9,51,10,1],[52,13,52,44,1],[53,17,53,77,1],[54,13,54,41,1],[55,17,55,74,1],[56,13,57,13,1],[57,13,57,14,1],[57,14,58,17,1],[58,17,58,37,1],[58,37,59,21,1],[59,21,59,61,1],[59,61,60,17,1],[60,17,60,30,1],[60,30,61,13,1],[61,13,61,14,1],[61,14,61,15,1],[56,13,61,15,1],[62,13,63,13,1],[63,13,63,14,1],[63,14,64,17,1],[64,17,64,37,1],[64,37,65,21,1],[65,21,65,58,1],[65,58,66,17,1],[66,17,66,29,1],[66,29,67,13,1],[67,13,67,14,1],[67,14,67,15,1],[62,13,67,15,1],[68,9,68,10,1],[71,68,71,102,1],[74,75,74,106,1]]);
    </script>
  </body>
</html>